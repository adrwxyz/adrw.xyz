{"version":3,"file":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-tech-2021-12-06-traefik-reverse-proxy-synology-md-cd2d3a949f4cc0943478.js","mappings":"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","sources":["webpack://adrw.xyz/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/components/post-footer.tsx","webpack://adrw.xyz/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/components/post.tsx","webpack://adrw.xyz/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/@lekoarts/gatsby-theme-minimal-blog-core/components/post.tsx","webpack://adrw.xyz/./content/posts/tech/2021-12-06-traefik-reverse-proxy-synology.md","webpack://adrw.xyz/./node_modules/@lekoarts/gatsby-theme-minimal-blog-core/src/templates/post-query.tsx","webpack://adrw.xyz/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/components/seo.tsx","webpack://adrw.xyz/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/components/item-tags.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport * as React from \"react\"\nimport type { MBPostProps } from \"./post\"\n\nconst PostFooter = ({ post }: MBPostProps) => null\n\nexport default PostFooter\n","/** @jsx jsx */\nimport type { HeadFC, PageProps } from \"gatsby\"\nimport * as React from \"react\"\nimport { jsx, Heading } from \"theme-ui\"\nimport Layout from \"./layout\"\nimport ItemTags from \"./item-tags\"\nimport Seo from \"./seo\"\nimport PostFooter from \"./post-footer\"\n\nexport type MBPostProps = {\n  post: {\n    slug: string\n    title: string\n    date: string\n    tags?: {\n      name: string\n      slug: string\n    }[]\n    description?: string\n    canonicalUrl?: string\n    excerpt: string\n    timeToRead?: number\n    banner?: {\n      childImageSharp: {\n        resize: {\n          src: string\n        }\n      }\n    }\n  }\n}\n\nconst px = [`16px`, `8px`, `4px`]\nconst shadow = px.map((v) => `rgba(0, 0, 0, 0.1) 0px ${v} ${v} 0px`)\n\nconst Post: React.FC<React.PropsWithChildren<PageProps<MBPostProps>>> = ({ data: { post }, children }) => (\n  <Layout>\n    <Heading as=\"h1\" variant=\"styles.h1\">\n      {post.title}\n    </Heading>\n    <p sx={{ color: `secondary`, mt: 3, a: { color: `secondary` }, fontSize: [1, 1, 2] }}>\n      <time>{post.date}</time>\n      {post.tags && (\n        <React.Fragment>\n          {` — `}\n          <ItemTags tags={post.tags} />\n        </React.Fragment>\n      )}\n      {post.timeToRead && ` — `}\n      {post.timeToRead && <span>{post.timeToRead} min read</span>}\n    </p>\n    <section\n      sx={{\n        my: 5,\n        \".gatsby-resp-image-wrapper\": {\n          my: [4, 4, 5],\n          borderRadius: `4px`,\n          boxShadow: shadow.join(`, `),\n          \".gatsby-resp-image-image\": {\n            borderRadius: `4px`,\n          },\n        },\n        variant: `layout.content`,\n      }}\n    >\n      {children}\n    </section>\n    <PostFooter post={post} />\n  </Layout>\n)\n\nexport default Post\n\nexport const Head: HeadFC<MBPostProps> = ({ data: { post } }) => (\n  <Seo\n    title={post.title}\n    description={post.description ? post.description : post.excerpt}\n    image={post.banner ? post.banner?.childImageSharp?.resize?.src : undefined}\n    pathname={post.slug}\n    canonicalUrl={post.canonicalUrl}\n  />\n)\n","import type { PageProps } from \"gatsby\"\nimport * as React from \"react\"\nimport Post, { Head, MBPostProps } from \"../../../components/post\"\n\nexport default function MinimalBlogCorePost({ ...props }: PageProps<MBPostProps>) {\n  return <Post {...props} />\n}\n\nexport { Head }\n","/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    pre: \"pre\",\n    code: \"code\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(_components.p, null, \"Synology DSM is great out of the box with training wheels but eventually you want to do a wheelie and need to free all of the default port bindings so you can run your own reverse proxy.\"), \"\\n\", React.createElement(_components.p, null, \"In my case, I wanted to run Traefik in a Docker container and let it handle routing of HTTPS and other port traffic since editing Traefik YAML files gets to be a bit easier and faster than clicking through Synology's Reverse Proxy UI for every port and service combination.\"), \"\\n\", React.createElement(_components.p, null, \"This \", React.createElement(_components.a, {\n    href: \"https://gist.github.com/hjbotha/f64ef2e0cd1e8ba5ec526dcd6e937dd7\"\n  }, \"free_ports.sh\"), \" script ended up doing the trick to free Synology's bindings of standard HTTPS, and HTTP ports which then would allow the Traefik container to bind to 80, 443 and others without contention and thus manage reverse proxy and SSL certificates and termination outside of Synology DSM.\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-bash\"\n  }, \"#! /bin/bash\\n\\n# NEWLY ADDED BACKUP FUNCTIONALITY IS NOT FULLY TESTED YET, USE WITH CARE, ESPECIALLY DELETION\\n# Developed for DSM 6/7. Not tested on other versions.\\n# Steps to install\\n# Save this script in one of your shares\\n# Backup /usr/syno/share/nginx/ as follows:\\n# # cd /usr/syno/share/\\n# # tar cvf ~/nginx.tar nginx\\n# Run this script as root\\n# Reboot and ensure everything is still working\\n# If not, restore the backup and post a comment on this script's gist page\\n# If it did, schedule it to run at boot\\n#   through Control Panel -> Task Scheduler\\n\\nHTTP_PORT=81\\nHTTPS_PORT=444\\n\\nBACKUP_FILES=true # change to false to disable backups\\nBACKUP_DIR=/volume1/apps/free_ports/backup\\nDELETE_OLD_BACKUPS=false # change to true to automatically delete old backups.\\nKEEP_BACKUP_DAYS=30\\nCURRENT_BACKUP_DIR=\\\"$BACKUP_DIR/$DATE\\\"\\n\\nDATE=$(date +%Y-%m-%d-%H-%M-%S)\\n\\nif [ \\\"$BACKUP_FILES\\\" == \\\"true\\\" ]; then\\n  mkdir -p \\\"$CURRENT_BACKUP_DIR\\\"\\n  cp /usr/syno/share/nginx/*.mustache \\\"$CURRENT_BACKUP_DIR\\\"\\nfi\\n\\nif [ \\\"$DELETE_OLD_BACKUPS\\\" == \\\"true\\\" ]; then\\n  find \\\"$BACKUP_DIR/\\\" -type d -mtime +$KEEP_BACKUP_DAYS -exec rm -r {} \\\\;\\nfi\\n\\nsed -i \\\"s/^\\\\([ \\\\t]\\\\+listen[ \\\\t]\\\\+[]:[]*\\\\)80\\\\([^0-9]\\\\)/\\\\1$HTTP_PORT\\\\2/\\\" /usr/syno/share/nginx/*.mustache\\nsed -i \\\"s/^\\\\([ \\\\t]\\\\+listen[ \\\\t]\\\\+[]:[]*\\\\)443\\\\([^0-9]\\\\)/\\\\1$HTTPS_PORT\\\\2/\\\" /usr/syno/share/nginx/*.mustache\\n\\necho \\\"Made these changes:\\\"\\n\\ndiff /usr/syno/share/nginx/ $CURRENT_BACKUP_DIR 2>&1 | tee $CURRENT_BACKUP_DIR/changes.log\\n\\n# Perform nginx reload if running on DSM 7.X\\nif grep -q 'majorversion=\\\"7\\\"' \\\"/etc.defaults/VERSION\\\"; then\\n  nginx -s reload\\nfi\\n# Might need to manually run $ sudo systemctl restart nginx\\n\")));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import React from \"react\";\nimport GATSBY_COMPILED_MDX from \"/home/runner/work/adrw.xyz/adrw.xyz/content/posts/tech/2021-12-06-traefik-reverse-proxy-synology.md\";\nimport PostComponent, {Head} from \"../components/post\";\nPostComponent\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(PostComponent, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\nexport {Head};\nconst query = \"2040642971\";\n","import * as React from \"react\"\nimport { withPrefix } from \"gatsby\"\nimport useSiteMetadata from \"../hooks/use-site-metadata\"\n\ntype SEOProps = {\n  title?: string\n  description?: string\n  pathname?: string\n  image?: string\n  children?: React.ReactNode\n  canonicalUrl?: string\n}\n\nconst Seo = ({\n  title = ``,\n  description = ``,\n  pathname = ``,\n  image = ``,\n  children = null,\n  canonicalUrl = ``,\n}: SEOProps) => {\n  const site = useSiteMetadata()\n\n  const {\n    siteTitle,\n    siteTitleAlt: defaultTitle,\n    siteUrl,\n    siteDescription: defaultDescription,\n    siteImage: defaultImage,\n    author,\n    siteLanguage,\n  } = site\n\n  const seo = {\n    title: title ? `${title} | ${siteTitle}` : defaultTitle,\n    description: description || defaultDescription,\n    url: `${siteUrl}${pathname || ``}`,\n    image: `${siteUrl}${image || defaultImage}`,\n  }\n  return (\n    <>\n      <html lang={siteLanguage} />\n      <title>{seo.title}</title>\n      <meta name=\"description\" content={seo.description} />\n      <meta name=\"image\" content={seo.image} />\n      <meta property=\"og:title\" content={seo.title} />\n      <meta property=\"og:url\" content={seo.url} />\n      <meta property=\"og:description\" content={seo.description} />\n      <meta property=\"og:image\" content={seo.image} />\n      <meta property=\"og:type\" content=\"website\" />\n      <meta property=\"og:image:alt\" content={seo.description} />\n      <meta name=\"twitter:card\" content=\"summary_large_image\" />\n      <meta name=\"twitter:title\" content={seo.title} />\n      <meta name=\"twitter:url\" content={seo.url} />\n      <meta name=\"twitter:description\" content={seo.description} />\n      <meta name=\"twitter:image\" content={seo.image} />\n      <meta name=\"twitter:image:alt\" content={seo.description} />\n      <meta name=\"twitter:creator\" content={author} />\n      <meta name=\"gatsby-theme\" content=\"@lekoarts/gatsby-theme-minimal-blog\" />\n      <link rel=\"icon\" type=\"image/png\" sizes=\"32x32\" href={withPrefix(`/favicon-32x32.png`)} />\n      <link rel=\"icon\" type=\"image/png\" sizes=\"16x16\" href={withPrefix(`/favicon-16x16.png`)} />\n      <link rel=\"apple-touch-icon\" sizes=\"180x180\" href={withPrefix(`/apple-touch-icon.png`)} />\n      {canonicalUrl ? <link rel=\"canonical\" href={canonicalUrl} /> : null}\n      {children}\n    </>\n  )\n}\n\nexport default Seo\n","/** @jsx jsx */\nimport { jsx } from \"theme-ui\"\nimport * as React from \"react\"\nimport { Link } from \"gatsby\"\nimport useMinimalBlogConfig from \"../hooks/use-minimal-blog-config\"\nimport replaceSlashes from \"../utils/replaceSlashes\"\n\ntype TagsProps = {\n  tags: {\n    name: string\n    slug: string\n  }[]\n}\n\nconst ItemTags = ({ tags }: TagsProps) => {\n  const { tagsPath, basePath } = useMinimalBlogConfig()\n\n  return (\n    <React.Fragment>\n      {tags.map((tag, i) => (\n        <React.Fragment key={tag.slug}>\n          {!!i && `, `}\n          <Link sx={(t) => ({ ...t.styles?.a })} to={replaceSlashes(`/${basePath}/${tagsPath}/${tag.slug}`)}>\n            {tag.name}\n          </Link>\n        </React.Fragment>\n      ))}\n    </React.Fragment>\n  )\n}\n\nexport default ItemTags\n"],"names":["_ref","post","shadow","map","v","data","children","jsx","Layout","Heading","as","variant","title","sx","color","mt","a","fontSize","date","tags","React","ItemTags","timeToRead","my","borderRadius","boxShadow","join","PostFooter","Head","_ref2","_post$banner","_post$banner$childIma","_post$banner$childIma2","Seo","description","excerpt","image","banner","childImageSharp","resize","src","undefined","pathname","slug","canonicalUrl","MinimalBlogCorePost","props","Post","_createMdxContent","_components","Object","assign","p","pre","code","_provideComponents","components","href","className","wrapper","MDXLayout","GatsbyMDXWrapper","PostComponent","GATSBY_COMPILED_MDX","site","useSiteMetadata","siteTitle","siteTitleAlt","defaultTitle","siteUrl","siteDescription","defaultDescription","siteImage","defaultImage","author","siteLanguage","seo","url","lang","name","content","property","rel","type","sizes","withPrefix","tagsPath","basePath","useMinimalBlogConfig","tag","i","key","Link","t","_t$styles","styles","to","replaceSlashes"],"sourceRoot":""}