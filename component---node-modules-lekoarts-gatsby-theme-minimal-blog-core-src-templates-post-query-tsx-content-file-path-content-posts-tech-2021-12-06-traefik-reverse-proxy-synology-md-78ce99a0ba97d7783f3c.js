"use strict";(self.webpackChunkadrw_xyz=self.webpackChunkadrw_xyz||[]).push([[7625],{1173:function(e,t,n){n.d(t,{p:function(){return p},A:function(){return d}});var a=n(6540),r=n(557),i=n(6835),o=n(3328),l=n(7715),s=n(7169);var c=e=>{let{post:t}=e;return null};const m=["16px","8px","4px"].map((e=>"rgba(0, 0, 0, 0.1) 0px "+e+" "+e+" 0px"));var u=e=>{let{data:{post:t},children:n}=e;return(0,r.Y)(o.A,null,(0,r.Y)(i.DZ,{as:"h1",variant:"styles.h1"},t.title),(0,r.Y)("p",{sx:{color:"secondary",mt:3,a:{color:"secondary"},fontSize:[1,1,2]}},(0,r.Y)("time",null,t.date),t.tags&&(0,r.Y)(a.Fragment,null," — ",(0,r.Y)(l.A,{tags:t.tags})),t.timeToRead&&" — ",t.timeToRead&&(0,r.Y)("span",null,t.timeToRead," min read")),(0,r.Y)("section",{sx:{my:5,".gatsby-resp-image-wrapper":{my:[4,4,5],borderRadius:"4px",boxShadow:m.join(", "),".gatsby-resp-image-image":{borderRadius:"4px"}},variant:"layout.content"}},n),(0,r.Y)(c,{post:t}))};const p=e=>{var t,n,a;let{data:{post:i}}=e;return(0,r.Y)(s.A,{title:i.title,description:i.description?i.description:i.excerpt,image:i.banner?null===(t=i.banner)||void 0===t||null===(n=t.childImageSharp)||void 0===n||null===(a=n.resize)||void 0===a?void 0:a.src:void 0,pathname:i.slug,canonicalUrl:i.canonicalUrl})};function d(e){let{...t}=e;return a.createElement(u,t)}},3279:function(e,t,n){n.r(t),n.d(t,{Head:function(){return l.p},default:function(){return s}});var a=n(6540),r=n(8453);function i(e){const t=Object.assign({p:"p",a:"a",pre:"pre",code:"code"},(0,r.RP)(),e.components);return a.createElement(a.Fragment,null,a.createElement(t.p,null,"Synology DSM is great out of the box with training wheels but eventually you want to do a wheelie and need to free all of the default port bindings so you can run your own reverse proxy."),"\n",a.createElement(t.p,null,"In my case, I wanted to run Traefik in a Docker container and let it handle routing of HTTPS and other port traffic since editing Traefik YAML files gets to be a bit easier and faster than clicking through Synology's Reverse Proxy UI for every port and service combination."),"\n",a.createElement(t.p,null,"This ",a.createElement(t.a,{href:"https://gist.github.com/hjbotha/f64ef2e0cd1e8ba5ec526dcd6e937dd7"},"free_ports.sh")," script ended up doing the trick to free Synology's bindings of standard HTTPS, and HTTP ports which then would allow the Traefik container to bind to 80, 443 and others without contention and thus manage reverse proxy and SSL certificates and termination outside of Synology DSM."),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-bash"},'#! /bin/bash\n\n# NEWLY ADDED BACKUP FUNCTIONALITY IS NOT FULLY TESTED YET, USE WITH CARE, ESPECIALLY DELETION\n# Developed for DSM 6/7. Not tested on other versions.\n# Steps to install\n# Save this script in one of your shares\n# Backup /usr/syno/share/nginx/ as follows:\n# # cd /usr/syno/share/\n# # tar cvf ~/nginx.tar nginx\n# Run this script as root\n# Reboot and ensure everything is still working\n# If not, restore the backup and post a comment on this script\'s gist page\n# If it did, schedule it to run at boot\n#   through Control Panel -> Task Scheduler\n\nHTTP_PORT=81\nHTTPS_PORT=444\n\nBACKUP_FILES=true # change to false to disable backups\nBACKUP_DIR=/volume1/apps/free_ports/backup\nDELETE_OLD_BACKUPS=false # change to true to automatically delete old backups.\nKEEP_BACKUP_DAYS=30\nCURRENT_BACKUP_DIR="$BACKUP_DIR/$DATE"\n\nDATE=$(date +%Y-%m-%d-%H-%M-%S)\n\nif [ "$BACKUP_FILES" == "true" ]; then\n  mkdir -p "$CURRENT_BACKUP_DIR"\n  cp /usr/syno/share/nginx/*.mustache "$CURRENT_BACKUP_DIR"\nfi\n\nif [ "$DELETE_OLD_BACKUPS" == "true" ]; then\n  find "$BACKUP_DIR/" -type d -mtime +$KEEP_BACKUP_DAYS -exec rm -r {} \\;\nfi\n\nsed -i "s/^\\([ \\t]\\+listen[ \\t]\\+[]:[]*\\)80\\([^0-9]\\)/\\1$HTTP_PORT\\2/" /usr/syno/share/nginx/*.mustache\nsed -i "s/^\\([ \\t]\\+listen[ \\t]\\+[]:[]*\\)443\\([^0-9]\\)/\\1$HTTPS_PORT\\2/" /usr/syno/share/nginx/*.mustache\n\necho "Made these changes:"\n\ndiff /usr/syno/share/nginx/ $CURRENT_BACKUP_DIR 2>&1 | tee $CURRENT_BACKUP_DIR/changes.log\n\n# Perform nginx reload if running on DSM 7.X\nif grep -q \'majorversion="7"\' "/etc.defaults/VERSION"; then\n  nginx -s reload\nfi\n# Might need to manually run $ sudo systemctl restart nginx\n')))}var o=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,r.RP)(),e.components);return t?a.createElement(t,e,a.createElement(i,e)):i(e)},l=n(1173);function s(e){return a.createElement(l.A,e,a.createElement(o,e))}l.A},7169:function(e,t,n){var a=n(6540),r=n(4194),i=n(7533);t.A=e=>{let{title:t="",description:n="",pathname:o="",image:l="",children:s=null,canonicalUrl:c=""}=e;const m=(0,i.A)(),{siteTitle:u,siteTitleAlt:p,siteUrl:d,siteDescription:g,siteImage:h,author:f,siteLanguage:E}=m,y={title:t?t+" | "+u:p,description:n||g,url:""+d+(o||""),image:""+d+(l||h)};return a.createElement(a.Fragment,null,a.createElement("html",{lang:E}),a.createElement("title",null,y.title),a.createElement("meta",{name:"description",content:y.description}),a.createElement("meta",{name:"image",content:y.image}),a.createElement("meta",{property:"og:title",content:y.title}),a.createElement("meta",{property:"og:url",content:y.url}),a.createElement("meta",{property:"og:description",content:y.description}),a.createElement("meta",{property:"og:image",content:y.image}),a.createElement("meta",{property:"og:type",content:"website"}),a.createElement("meta",{property:"og:image:alt",content:y.description}),a.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),a.createElement("meta",{name:"twitter:title",content:y.title}),a.createElement("meta",{name:"twitter:url",content:y.url}),a.createElement("meta",{name:"twitter:description",content:y.description}),a.createElement("meta",{name:"twitter:image",content:y.image}),a.createElement("meta",{name:"twitter:image:alt",content:y.description}),a.createElement("meta",{name:"twitter:creator",content:f}),a.createElement("meta",{name:"gatsby-theme",content:"@lekoarts/gatsby-theme-minimal-blog"}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:(0,r.withPrefix)("/favicon-32x32.png")}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:(0,r.withPrefix)("/favicon-16x16.png")}),a.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:(0,r.withPrefix)("/apple-touch-icon.png")}),c?a.createElement("link",{rel:"canonical",href:c}):null,s)}},7715:function(e,t,n){var a=n(557),r=n(6540),i=n(4194),o=n(3601),l=n(2174);t.A=e=>{let{tags:t}=e;const{tagsPath:n,basePath:s}=(0,o.A)();return(0,a.Y)(r.Fragment,null,t.map(((e,t)=>(0,a.Y)(r.Fragment,{key:e.slug},!!t&&", ",(0,a.Y)(i.Link,{sx:e=>{var t;return{...null===(t=e.styles)||void 0===t?void 0:t.a}},to:(0,l.A)("/"+s+"/"+n+"/"+e.slug)},e.name)))))}}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-tech-2021-12-06-traefik-reverse-proxy-synology-md-78ce99a0ba97d7783f3c.js.map